function eventListenerz(){var n=document.getElementById("save");n.addEventListener("click",canvasDrawing.save,!1)}!function(){for(var n=0,i=["ms","moz","webkit","o"],t=0;t<i.length&&!window.requestAnimationFrame;++t)window.requestAnimationFrame=window[i[t]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[i[t]+"CancelAnimationFrame"]||window[i[t]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(i){var t=(new Date).getTime(),e=Math.max(0,16-(t-n)),a=window.setTimeout(function(){i(t+e)},e);return n=t+e,a}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(n){clearTimeout(n)})}();var canvasDrawing={options:{maxSize:500,lineWidth:.5,speed:5,hue:180,mirrors:2},animation:null,canvas:null,context:null,winWidth:window.innerWidth,winHeight:window.innerHeight,mouse:{x:-1e3,y:-1e3,down:!1},mousePrev:{x:-1e3,y:-1e3},degrees:145,init:function(){this.canvas=document.getElementById("canvas"),this.context=canvas.getContext("2d"),this.canvas.width=this.winWidth,this.canvas.height=this.winHeight,this.canvas.addEventListener("mousemove",this.mouseMove,!1),this.canvas.addEventListener("mousedown",this.clickDown,!0),this.canvas.addEventListener("mouseup",this.clickUp,!1),this.canvas.addEventListener("mouseout",this.mouseOut,!1),this.canvas.addEventListener("dblclick",this.doubleClik,!1),this.draw(),window.onresize=function(){canvasDrawing.winWidth=window.innerWidth,canvasDrawing.winHeight=window.innerHeight,canvasDrawing.canvas.width=canvasDrawing.winWidth,canvasDrawing.canvas.height=canvasDrawing.winHeight}},drawLines:function(){if(this.mouse.down!==!0){var n,i,t,e,a,s,o,c,w=Math.sqrt(Math.pow(this.mousePrev.x-this.mouse.x,2)+Math.pow(this.mousePrev.y-this.mouse.y,2)),h=w/this.winWidth*1e3+this.options.maxSize,r=w/this.winWidth*10+.1,d=this.degrees*(Math.PI/180),v=(this.degrees+180)*(Math.PI/180);n=this.mouse.x+Math.sin(d)*h,i=this.mouse.y+Math.cos(d)*h,t=this.mouse.x+Math.sin(v)*h,e=this.mouse.y+Math.cos(v)*h,a=this.winWidth-n,s=this.winHeight-i,o=this.winWidth-t,c=this.winHeight-e,this.context.strokeStyle="hsla("+this.options.hue+", 100%, 50%, "+r+")",this.context.lineWidth=this.options.lineWidth,this.context.beginPath(),this.context.moveTo(n,i),this.context.lineTo(t,e),this.context.moveTo(a,i),this.context.lineTo(o,e),this.context.moveTo(n,s),this.context.lineTo(t,c),this.context.moveTo(a,s),this.context.lineTo(o,c),this.context.stroke(),this.degrees+=this.options.speed}},draw:function(){this.animation=requestAnimationFrame(function(){canvasDrawing.draw()}),this.drawLines(),this.mousePrev.x=this.mouse.x,this.mousePrev.y=this.mouse.y},clear:function(){canvasDrawing.canvas.width=canvasDrawing.canvas.width},save:function(){canvasDrawing.context.globalCompositeOperation="destination-over",canvasDrawing.context.fillRect(0,0,canvasDrawing.winWidth,canvasDrawing.winHeight);var n=canvasDrawing.canvas.toDataURL("image/jpg");window.open(n,"_blank"),window.focus()},mouseMove:function(n){canvasDrawing.mouse.x=n.offsetX||n.layerX-canvasDrawing.canvas.offsetLeft,canvasDrawing.mouse.y=n.offsetY||n.layerY-canvasDrawing.canvas.offsetTop},clickDown:function(){canvasDrawing.mouse.down=canvasDrawing.mouse.down===!1?!0:!1},clickUp:function(){canvasDrawing.mouse.down=canvasDrawing.mouse.down===!0?!0:!1},mouseOut:function(){canvasDrawing.mouse.down=!1},doubleClik:function(){canvasDrawing.clear()}};window.onload=function(){canvasDrawing.init(),eventListenerz()};
