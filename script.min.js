function events(){save=document.getElementById("save"),save.addEventListener("click",canvasDrawing.save,!1)}!function(){for(var a=0,b=["ms","moz","webkit","o"],c=0;c<b.length&&!window.requestAnimationFrame;++c)window.requestAnimationFrame=window[b[c]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[b[c]+"CancelAnimationFrame"]||window[b[c]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(b){var d=(new Date).getTime(),e=Math.max(0,16-(d-a)),f=window.setTimeout(function(){b(d+e)},e);return a=d+e,f}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(a){clearTimeout(a)})}();var canvasDrawing={options:{maxSize:500,lineWidth:.5,speed:5,hue:180},animation:null,canvas:null,context:null,windowWidth:window.innerWidth,windowHeight:window.innerHeight,mouse:{x:0,y:0,down:!1},mousePrev:{x:-1e3,y:-1e3},degrees:145,init:function(){this.canvas=document.getElementById("canvas"),this.context=canvas.getContext("2d"),this.canvas.width=this.windowWidth,this.canvas.height=this.windowHeight,this.canvas.addEventListener("mousemove",this.movingMouse,!1),this.canvas.addEventListener("mousedown",this.clickDown,!0),this.canvas.addEventListener("mouseup",this.clickUp,!1),this.canvas.addEventListener("mouseout",this.outOfBounds,!1),this.canvas.addEventListener("dblclick",this.doubleClick,!1),this.mouse.down=!0,this.draw(),window.onresize=function(){canvasDrawing.windowWidth=window.innerWidth,canvasDrawing.windowHeight=window.innerHeight,canvasDrawing.canvas.width=canvasDrawing.windowWidth,canvasDrawing.canvas.height=canvasDrawing.windowHeight}},drawPatterns:function(){if(this.mouse.down){var f,g,h,i,j,k,l,m,a=Math.sqrt(Math.pow(this.mousePrev.x-this.mouse.x,2)+Math.pow(this.mousePrev.y-this.mouse.y,2)),b=1e3*(a/this.windowWidth)+this.options.maxSize,c=10*(a/this.windowWidth)+.1,d=this.degrees*(Math.PI/180),e=(this.degrees+180)*(Math.PI/180);f=this.mouse.x+Math.sin(d)*b,g=this.mouse.y+Math.cos(d)*b,h=this.mouse.x+Math.sin(e)*b,i=this.mouse.y+Math.cos(e)*b,j=this.windowWidth-f,k=this.windowHeight-g,l=this.windowWidth-h,m=this.windowHeight-i,this.context.strokeStyle="hsla("+this.options.hue+", 100%, 50%, "+c+")",this.context.lineWidth=this.options.lineWidth,this.context.beginPath(),this.context.moveTo(f,g),this.context.lineTo(h,i),this.context.moveTo(f,k),this.context.lineTo(h,m),this.context.moveTo(j,k),this.context.lineTo(l,m),this.context.stroke(),this.degrees+=this.options.speed}},draw:function(){this.animation=requestAnimationFrame(function(){canvasDrawing.draw()}),this.drawPatterns(),this.mousePrev.x=this.mouse.x,this.mousePrev.y=this.mouse.y},clear:function(){canvasDrawing.canvas.width=canvasDrawing.canvas.width},save:function(){1===canvasDrawing.options.bgColor&&(canvasDrawing.context.globalCompositeOperation="destination-over",canvasDrawing.context.fillStyle="#000",canvasDrawing.context.fillRect(0,0,canvasDrawing.windowWidth,canvasDrawing.windowHeight));var a=canvasDrawing.canvas.toDataURL("image/jpg");window.open(a,"_blank"),window.focus()},movingMouse:function(a){canvasDrawing.mouse.x=a.offsetX||a.layerX-canvasDrawing.canvas.offsetLeft,canvasDrawing.mouse.y=a.offsetY||a.layerY-canvasDrawing.canvas.offsetTop},clickDown:function(){canvasDrawing.mouse.down=canvasDrawing.mouse.down===!1?!0:!1},clickUp:function(){canvasDrawing.mouse.down=canvasDrawing.mouse.down===!1?!1:!0},outOfBounds:function(){canvasDrawing.mouse.down=!1},doubleClick:function(){canvasDrawing.clear()},save:function(){canvasDrawing.context.globalCompositeOperation="destination-over",canvasDrawing.context.fillRect(0,0,canvasDrawing.windowWidth,canvasDrawing.windowHeight);var a=canvasDrawing.canvas.toDataURL("image/jpg");window.open(a,"_blank"),window.focus()}};window.onload=function(){canvasDrawing.init(),events()};
